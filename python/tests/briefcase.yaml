credentials:
  myvault1: &myvault1
    !azure.keyvault
    dnsname: https://webscaleai.vault.azure.net/
    tenantid: 72f988bf-86f1-41af-91ab-2d7cd011db47

 # TODO: add support for unknown types
 #  armprovider:
 #   !azure.arm.credentialprovider
 #   tenantid: 123a-234a

datasources: # just convention, support arbitrary structure
  folder1:
    myblobsource1: &myblobsource1 
      !azure.storage.account
      accountname: webscaleai
      credentialprovider: *myvault1

    myblobsource2: &myblobsource2 
      !azure.storage.account
      accountname: storage2
      secrettype: SAS

    unknown1:
      !resource
      a: 1
      b: 2
      
  folder2:
    sqlalchemy:
      !python.sqlalchemy
      # TODO: support $secret$ replacement
      # support escaping this... e.g. $$secret$$?
      url: postgresql://scott:$secret$@localhost:5432/mydatabase


cogservices:
  video: # define key under cogservices.video
    s3:
      !aws.s3
      foo: 1

    queue:
      !aws.queue
      foo: 1

datasets:
  criteo:
    day0:
      !azure.storage.blob
      datasource: *myblobsource1
      containername: criteo
      path: 1_csv/day_0.gz

    all_days: &all_days
      !azure.storage.blob
      datasource: *myblobsource1
      containername: criteo
      path: 1_csv/*gz

    csv2:
      !csv
      dataset: *all_days

    bar:
      !resource
      a: 1
      x: 2

  test:
    csv1:
      !csv
      # supports all options azureml.dataprep.read_csv exposes
      url: data/test.csv
      separator: "\t"

services:
  cognitiveservice:
    anom1:
      # semantic hierarchy organizing resources (-> MLSpec)
      !azure.cognitiveservice.anomalydetection
      credentialprovider: 
        !python.keyring
        foo: 1 # TODO: not sure why I need at least 1 property?
      url: https://foo.bar
